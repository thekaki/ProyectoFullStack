/*!
 * Start Bootstrap - SB Admin 2 v4.1.3 (https://startbootstrap.com/theme/sb-admin-2)
 * Copyright 2013-2025 Start Bootstrap
 * Licensed under MIT (https://github.com/StartBootstrap/startbootstrap-sb-admin-2/blob/master/LICENSE)
 */

const TOKEN_KEY="token";function saveTokenFromResponse(e){var t=e.type||"Bearer",e=e.token||e.accessToken||e.access_token||"";e&&localStorage.setItem(TOKEN_KEY,`${t} ${e}`)}function getAuthHeaderValue(){return localStorage.getItem(TOKEN_KEY)}function getRawToken(){const e=getAuthHeaderValue();if(!e)return null;if(e.startsWith("Bearer "))return e.substring(7);var t=e.split(" ");return 1<t.length?t[1]:e}function removeToken(){localStorage.removeItem(TOKEN_KEY)}function parseJwtPayload(e){try{const i=e.split(".")[1];if(!i)return null;var t=i.replace(/-/g,"+").replace(/_/g,"/"),n=(4-t.length%4)%4,o=t+"=".repeat(n),r=decodeURIComponent(atob(o).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(r)}catch(e){return null}}function isTokenExpired(e){if(!e)return!0;e=parseJwtPayload(e);return!e||(!e.exp||Date.now()/1e3>=e.exp)}function requireAuth(){var e=getAuthHeaderValue(),t=getRawToken();return e&&t&&!isTokenExpired(t)?("hidden"===document.documentElement.style.visibility&&(document.documentElement.style.visibility=""),!0):(removeToken(),window.location.replace("login.html"),!1)}async function apiFetch(e,t={}){const n=Object.assign({Accept:"application/json","Content-Type":"application/json"},t.headers||{});var o=getAuthHeaderValue();if(!o)throw removeToken(),window.location.replace("login.html"),new Error("No token");n.Authorization=o;t=await fetch(e,{...t,headers:n});if(401===t.status||403===t.status)throw removeToken(),window.location.replace("login.html"),new Error("Unauthorized");return t}!function(){try{"hidden"!==document.documentElement.style.visibility&&(document.documentElement.style.visibility="hidden"),requireAuth()}catch(e){removeToken(),window.location.replace("login.html")}}();